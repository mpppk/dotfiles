- hosts: gce_ubuntu
  user: yuki
  tasks:
    - name: "apt-get install git"
      apt: pkg=git
      become: yes
    - name: install fish repo
      apt_repository:
        repo="ppa:fish-shell/release-2"
        state=present
        update_cache=yes
      when: ansible_distribution == "Ubuntu"
    - name: install fish
      apt: name=fish state=present
    - name: make the fisherman directory
      file:
        path="{{ ansible_env.HOME }}/.config/fish/functions"
        state=directory
        owner="{{ ansible_env.USER }}"
        mode=0755
        recurse=yes
    - name: install fisherman
      get_url:
        url="https://git.io/fisherman"
        dest="{{ ansible_env.HOME }}/.config/fish/functions/fisher.fish"
    - name: configure | change default shell
      user: name="{{ ansible_env.USER }}" shell="/usr/local/bin/fish"
      become: yes